
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    
    <title>三目並べでニューラルネットワーク（正）</title>

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1752720-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      
      gtag('config', 'UA-1752720-7');
    </script>
    <meta name="author" content="happyclam">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
      <script src="/assets/themes/twitter/js/excanvas.min.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link rel="shortcut icon" href="/images/favicon.ico">
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images

    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@SappierBoy">
  <meta name="twitter:creator" content="@SappierBoy">
  
  <meta name="twitter:title" content="三目並べでニューラルネットワーク（正）">
  
  
  <meta name="twitter:url" content="/project/2017-07-07/neuralnw2">
  
  
  <meta name="twitter:description" content="AIの機械学習には信賞必罰が必要？前回の記事、間違ってたので修正しました。">
  
  
  <meta name="twitter:image:src" content="/images/logo_114.png">
  

  <link rel="canonical" href="/project/2017-07-07/neuralnw2" />
    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script language="JavaScript">
$(document).ready( function () {
    $("a[href^='http']:not([href*='" + location.hostname + "'])").attr('target', '_blank');
})
</script>
<script src="/assets/themes/twitter/js/jquery.min.js"></script>
<script src="/assets/themes/twitter/js/jquery.flot.min.js"></script>
<script src="/assets/themes/twitter/js/flotr2.min.js" type="text/javascript"></script>
<script src="/assets/themes/twitter/js/jquery.flot.selection.js" type="text/javascript" ></script>
<script src="/assets/themes/twitter/js/jekyll-search.js" type="text/javascript"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-1752720-7', 'happyclam.github.io');
      ga('send', 'pageview');
    </script>
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ['$', '$'] ],
    displayMath: [ ['$$', '$$']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  messageStyle: "none",
  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
  </head>

  <body>
    <div style="text-align: center;">
      <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-9018029357773039",
        enable_page_level_ads: true
        });
      </script>
    </div>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">自己満足プログラミング</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages">Pages</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/policy">Policy</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/profile">About</a></li>
      	
      
    
  
    
      
    
  
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  
    
  
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">
      <div class="row-fluid">
        <div class="span3">
        <a href="https://twitter.com/share" class="twitter-share-button" data-via="SappierBoy">Tweet</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
        </div>
        <div class="span9" html elements for search>
             <div id="search-container" align="right">
               <input type="text" id="search-input" placeholder="search...">
               <ul id="results-container"></ul>
             </div>
             <div class="results"></div>
        </div>
      </div>
<script type="text/javascript">
  SimpleJekyllSearch.init({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('results-container'),
    json: '/search.json',
    searchResultTemplate: '<li><a href="{url}" title="{category}:{title}">{title}</a></li>',
    noResultsText: 'No results found',
    limit: 15,
    fuzzy: false,
  })
</script>
      <div class="content">
        
<div class="page-header">
  <h1>三目並べでニューラルネットワーク（正） </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>07 July 2017</span>
    </div>
    <div class="content">
      <p>Project: 「<strong>三目並べ</strong>」: <a href="https://github.com/happyclam/tictactoe_ruby/tree/neural">neural</a></p>

<h3 id="aiの学習は信賞必罰が必要">AIの学習は信賞必罰が必要？</h3>
<p>　<a href="/project/2017-07-01/neuralnw">前回記事</a>の訂正のための記事です。前回の内容がすべて間違っているわけじゃないので、比較のために前回の記事も残してます。合わせて読んでいただければと思います。前回の記事で「勝っても負けても勝った方の指し手を教師データとして、勝った方の手番の局面データの重みを勾配法を使って誤差修正する」というやり方を試したことを書きました。そして、それっぽいテスト結果が得られたので、現在作成中の「消える三目並べ」（３手前に打った自分の駒が消えるルールの三目並べ）に適応して遊んでみたところ、何度も同じパターンの負け方をして学習が進んでいる気配を感じられなかったのです。ゲームの特性上負けを避けられないケースもありますし、AIは最善手を選ぶ確率を上げるように学習するだけで必ず最善手を選ぶわけではないのでAI側が負けたからと言って必ずしもバグではないのですが、初手から数手で単純に負ける酷い負け方が何回も続くのです。テストのためにかなりの回数「消える三目並べ」の対戦をしてきて自分も強くなっている<img class="emoji" title=":sweat_smile:" alt=":sweat_smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f605.png" height="20" width="20">ので、これは「弱すぎる」「おかしい」と分かります。何が悪かったのでしょうか？<br>
　どうやら「どちらが勝っても勝った方の指し手を教師データとした」ところが良くなかったようです。勝った方の手を教師データとしてばかりいると、相手がリーチを掛けた局面（あと一手で相手のラインが揃う局面）で相手のラインが揃うのを防がなかった場合に、それが原因でAIが負けたとしてもそれが悪いことだと学習する機会がありません（勝った側の手だけを学習するため）。相手がリーチを掛けた局面がAIの手番であればラインを揃える手（勝つ手）を逃すことはなくなりますが、自分が（AIが）負けた時に相手が揃うことを防がなかった手が悪い手だということを教える必要があります。つまり負けたら罰を与えないといけなかったようです。<br>
　ということで、結局、勝てば＋３、負ければ−１、引分は＋１というマジックナンバーを復活させることにしました。</p>

<h3 id="修正内容">修正内容</h3>
<p>　興味がある方はソースを確認していただけばいいと思いますが、前回は教師データとして９要素の配列（重みデータ）に正解手だけ1.0をセットして、それを教師データとして誤差修正していました。</p>
<pre style="overflow:auto; white-space:nowrap">
 教師データ
 [0, 0, 1.0, 0, 0, 0, 0, 0, 0]
</pre>
<p>　今回は勝てば3.0、負けは-1.0、引分は1.0をセットして誤差修正しています。</p>
<pre style="overflow:auto; white-space:nowrap">
 負けの場合の教師データ
 [0, 0, -1.0, 0, 0, 0, 0, 0, 0]<br>
 勝ちの場合の教師データ
 [0, 0, 3.0, 0, 0, 0, 0, 0, 0]<br>
 引分の場合の教師データ
 [0, 0, 1.0, 0, 0, 0, 0, 0, 0]
</pre>
<p>　<a href="https://www.amazon.co.jp/gp/product/4873117585/ref=as_li_tl?ie=UTF8&amp;camp=247&amp;creative=1211&amp;creativeASIN=4873117585&amp;linkCode=as2&amp;tag=happyclam-22&amp;linkId=ee2058c36d523f2bb6cdb157cd418f30">「ゼロから作るDeep Learning」</a>に記載されているsoftmax関数が合計1.0になるように按分してくれるので修正はこれだけです。<br>
　但し、勝ちが３で負けが−１と落差が激しいために発散するのか、良い結果が得られなかったので<strong>学習率</strong>を前回の<strong>0.1</strong>から<strong>0.03</strong>に大幅に下げました。</p>

<h5 id="-最強プログラムとの対戦結果-">– 最強プログラムとの対戦結果 –</h5>

<div id="neural_saikyo" style="width:600px;height:300px;"></div>
<div id="new_saikyo" style="width:600px;height:300px;"></div>

<p>　上の２つのグラフのうち下側のグラフは現在リリース中の<a href="https://play.google.com/store/apps/details?id=io.github.happyclam">「進化する三目並べ（Tic-tac-toe Evo）」</a>と同じものです。上側のニューラルネットワークのグラフは、前回間違ったプログラムを使って「学習速度が速い」なんて書いてしまいましたが、グラフを見る限りむしろ遅くなった感じです。それより特徴的なことは、学習がピークまで達すると間違った手を指さないようになっていることです。重みデータを加減算で操作している方法（下のグラフ）だと６０００回対戦後も５％ぐらいは間違った指し手を選んで負けているのに、勾配法を使ってる上のグラフだと６０００回対戦後は１００％引分に持ち込んでいます（間違った手を指していない）。指し手を選ぶ推論部分（重みデータの比率で指し手を選ぶ方法）は全く同じなのにこの差が出るのは、重みデータが圧倒的に偏った値になっているということです。<br>
　例えばゲームスタート時の初期盤面の学習データ（報酬データ）は、従来の加減算によるものでは<a href="/software/2015-10-25/machine_learning">以前の記事</a>にも書いたように、だいたい以下のような感じのデータになります。</p>
<pre style="overflow:auto; white-space:nowrap">
 初期盤面の報酬データ（加減算）
 [94, 32, 137, 98, 160, 95, 98, 84, 97]
</pre>
<p>　次にどんな手を選ぶか（推論部分）は、単に以下の確率で決まります。</p>
<div style="width:320px; margin: 0 auto;">
  <p><script type="math/tex">\frac{（対象となる箇所の学習データの値）}{（９箇所の学習データの合計値）}</script></p>
</div>
<p>だからこのデータの場合は、全配列の合計は<strong>895</strong>で盤面の真ん中のデータが<strong>160</strong>になっていますので、AIが先手の場合に<strong>160／895</strong>の確率で初手に真ん中を選ぶということを示しています。対して勾配法による学習後のデータは以下のようになりました。</p>
<pre style="overflow:auto;">
 初期盤面の報酬データ（勾配法）
[-0.7601376352001628, -0.7502935835767303, -0.7520158193991342, -0.742749527313905, 6.938823028629541, -0.7552042606689815, -0.7336853491261596, -0.7136915491061318, -0.7310453055201457] 
</pre>
<p>　合計は 0.9999999987181899（約 1.0 ）ですので、6.9 / 1.0 の確率（約７００％）、つまり初手は１００％真ん中を選ぶようになったということです。</p>

<h5 id="-乱数プログラムとの対戦結果-">– 乱数プログラムとの対戦結果 –</h5>
<div id="neural_random" style="width:600px;height:300px;"></div>
<div id="new_random" style="width:600px;height:300px;"></div>

<p>　乱数で指し手を決める弱いプログラム相手では、多少勝率が高いようですがほぼ似たような結果になりました。</p>

<h3 id="学習速度に関しては一概に言え無さそう">学習速度に関しては一概に言え無さそう</h3>
<p>　勾配法を用いたことで学習速度が若干悪くなったテスト結果（グラフ）を紹介しましたが、学習率を変えるとまた違ってくるかもしれません。とりあえず「通常の三目並べ」で試すのはここまでにして、今後作るアプリでいろいろ試して見ようと思ってます。今回修正した内容は<a href="https://github.com/happyclam/tictactoe_ruby/tree/neural">github</a>には適用していますので、興味のある方は見て下さい。</p>

<script type="text/javascript">
function show_new_saikyo(){
    var new_lose = [];
    var new_win = [[1, 87],[2, 57],[3, 65],[4, 53],[5, 59],[6, 47],[7, 41],[8, 42],[9, 35],[10, 31],[11, 32],[12, 32],[13, 20],[14, 22],[15, 18],[16, 20],[17, 12],[18, 14],[19, 7],[20, 12],[21, 8],[22, 8],[23, 9],[24, 8],[25, 3],[26, 9],[27, 5],[28, 6],[29, 3],[30, 5],[31, 4],[32, 2],[33, 4],[34, 3],[35, 5],[36, 5],[37, 2],[38, 9],[39, 6],[40, 1],[41, 4],[42, 3],[43, 4],[44, 4],[45, 3],[46, 4],[47, 1],[48, 1],[49, 1],[50, 5],[51, 1],[52, 2],[53, 3],[54, 1],[55, 4],[56, 3],[57, 1],[58, 3],[59, 1],[60, 1],[61, 1],[62, 5],[63, 4],[64, 3],[65, 4],[66, 3],[67, 1],[68, 4],[69, 1],[70, 0],[71, 3],[72, 4],[73, 2],[74, 4],[75, 2],[76, 4],[77, 5],[78, 0],[79, 2],[80, 0],[81, 0],[82, 0],[83, 3],[84, 1],[85, 0],[86, 0],[87, 0],[88, 1],[89, 0],[90, 2],[91, 1],[92, 4],[93, 0],[94, 1],[95, 1],[96, 3],[97, 0],[98, 2],[99, 2],[100, 1]];
    var new_draw = [[1 ,13],[2 ,43],[3 ,35],[4 ,47],[5 ,41],[6 ,53],[7 ,59],[8 ,58],[9 ,65],[10 ,69],[11 ,68],[12 ,68],[13 ,80],[14 ,78],[15 ,82],[16 ,80],[17 ,88],[18 ,86],[19 ,93],[20 ,88],[21 ,92],[22 ,92],[23 ,91],[24 ,92],[25 ,97],[26 ,91],[27 ,95],[28 ,94],[29 ,97],[30 ,95],[31 ,96],[32 ,98],[33 ,96],[34 ,97],[35 ,95],[36 ,95],[37 ,98],[38 ,91],[39 ,94],[40 ,99],[41 ,96],[42 ,97],[43 ,96],[44 ,96],[45 ,97],[46 ,96],[47 ,99],[48 ,99],[49 ,99],[50 ,95],[51 ,99],[52 ,98],[53 ,97],[54 ,99],[55 ,96],[56 ,97],[57 ,99],[58 ,97],[59 ,99],[60 ,99],[61 ,99],[62 ,95],[63 ,96],[64 ,97],[65 ,96],[66 ,97],[67 ,99],[68 ,96],[69 ,99],[70 ,100],[71 ,97],[72 ,96],[73 ,98],[74 ,96],[75 ,98],[76 ,96],[77 ,95],[78 ,100],[79 ,98],[80 ,100],[81 ,100],[82 ,100],[83 ,97],[84 ,99],[85 ,100],[86 ,100],[87 ,99],[88 ,99],[89 ,100],[90 ,98],[91 ,99],[92 ,96],[93 ,100],[94 ,99],[95 ,99],[96 ,97],[97 ,100],[98 ,98],[99 ,98],[100 ,99]];

    Flotr.draw(
        document.getElementById("new_saikyo"),
        [
            {data: new_lose, label: "勝ち"},
            {data: new_win, label: "負け"},
            {data: new_draw, label: "引分"}
        ],
        {
            title: "従来の方法、重みを加減算",
            subtitle: "対最強プログラム",
            HtmlText: false,
            bars:{show: true, stacked: true, horizontal:false},
            xaxis:{
                title: "対戦回数（×１００）",
                max: 110,
                noTicks: 10
            },
            yaxis:{
                title: "対戦結果（勝ち／負け／引き分け）",
                titleAngle: 90,
                max: 100,
                noTicks: 10
            },
            grid: {
                verticalLines: true,
                horizontalLines: true,
                outline: "ws"
            },
            mouse: {
                track:true,
                trackDecimals: 0
            }
        }
    );
}

function show_neural_saikyo(){
    var old_lose = [];
    var old_win = [[1, 81],[2, 79],[3, 81],[4, 70],[5, 48],[6, 53],[7, 48],[8, 49],[9, 40],[10, 46],[11, 45],[12, 50],[13, 54],[14, 35],[15, 48],[16, 53],[17, 53],[18, 51],[19, 51],[20, 41],[21, 35],[22, 37],[23, 45],[24, 42],[25, 39],[26, 42],[27, 32],[28, 39],[29, 32],[30, 30],[31, 31],[32, 26],[33, 25],[34, 25],[35, 15],[36, 13],[37, 9],[38, 10],[39, 9],[40, 8],[41, 15],[42, 4],[43, 10],[44, 3],[45, 3],[46, 9],[47, 5],[48, 4],[49, 3],[50, 7],[51, 3],[52, 6],[53, 1],[54, 2],[55, 4],[56, 5],[57, 3],[58, 5],[59, 2],[60, 4],[61, 0],[62, 1],[63, 1],[64, 0],[65, 1],[66, 0],[67, 0],[68, 0],[69, 0],[70, 0],[71, 0],[72, 0],[73, 0],[74, 0],[75, 0],[76, 0],[77, 0],[78, 0],[79, 0],[80, 0],[81, 0],[82, 0],[83, 0],[84, 0],[85, 0],[86, 0],[87, 0],[88, 0],[89, 0],[90, 0],[91, 0],[92, 0],[93, 0],[94, 0],[95, 0],[96, 0],[97, 0],[98, 0],[99, 0],[100, 0]];
    var old_draw = [[1 ,19],[2 ,21],[3 ,19],[4 ,30],[5 ,52],[6 ,47],[7 ,52],[8 ,51],[9 ,60],[10 ,54],[11 ,55],[12 ,50],[13 ,46],[14 ,65],[15 ,52],[16 ,47],[17 ,47],[18 ,49],[19 ,49],[20 ,59],[21 ,65],[22 ,63],[23 ,56],[24 ,58],[25 ,61],[26 ,58],[27 ,68],[28 ,61],[29 ,68],[30 ,70],[31 ,69],[32 ,74],[33 ,75],[34 ,75],[35 ,85],[36 ,87],[37 ,91],[38 ,90],[39 ,91],[40 ,92],[41 ,85],[42 ,96],[43 ,90],[44 ,97],[45 ,97],[46 ,91],[47 ,95],[48 ,96],[49 ,97],[50 ,93],[51 ,97],[52 ,94],[53 ,99],[54 ,98],[55 ,96],[56 ,95],[57 ,97],[58 ,95],[59 ,98],[60 ,96],[61 ,100],[62 ,99],[63 ,99],[64 ,100],[65 ,99],[66 ,100],[67 ,100],[68 ,100],[69 ,100],[70 ,100],[71 ,100],[72 ,100],[73 ,100],[74 ,100],[75 ,100],[76 ,100],[77 ,100],[78 ,100],[79 ,100],[80 ,100],[81 ,100],[82 ,100],[83 ,100],[84 ,100],[85 ,100],[86 ,100],[87 ,100],[88 ,100],[89 ,100],[90 ,100],[91 ,100],[92 ,100],[93 ,100],[94 ,100],[95 ,100],[96 ,100],[97 ,100],[98 ,100],[99 ,100],[100 ,100]];

    Flotr.draw(
        document.getElementById("neural_saikyo"),
        [
            {data: old_lose, label: "勝ち"},
            {data: old_win, label: "負け"},
            {data: old_draw, label: "引分"}
        ],
        {
            title: "ニューラルネットワーク、勾配法（修正後）",
            subtitle: "対最強プログラム",
            HtmlText: false,
            bars:{show: true, stacked: true, horizontal:false},
            xaxis:{
                title: "対戦回数（×１００）",
                max: 110,
                noTicks: 10
            },
            yaxis:{
                title: "対戦結果（勝ち／負け／引き分け）",
                titleAngle: 90,
                max: 100,
                noTicks: 10
            },
            grid: {
                verticalLines: true,
                horizontalLines: true,
                outline: "ws"
            },
            mouse: {
                track:true,
                trackDecimals: 0
            }
        }
    );
}

function show_new_random(){
    var new_lose = [[1, 36],[2, 43],[3, 49],[4, 39],[5, 51],[6, 55],[7, 62],[8, 51],[9, 51],[10, 66],[11, 56],[12, 61],[13, 60],[14, 60],[15, 69],[16, 62],[17, 78],[18, 58],[19, 67],[20, 67],[21, 72],[22, 66],[23, 71],[24, 65],[25, 62],[26, 69],[27, 74],[28, 69],[29, 72],[30, 67],[31, 64],[32, 65],[33, 79],[34, 68],[35, 73],[36, 76],[37, 81],[38, 72],[39, 80],[40, 76],[41, 65],[42, 67],[43, 70],[44, 69],[45, 74],[46, 75],[47, 68],[48, 78],[49, 73],[50, 76],[51, 74],[52, 74],[53, 66],[54, 70],[55, 79],[56, 80],[57, 79],[58, 74],[59, 73],[60, 62],[61, 81],[62, 69],[63, 81],[64, 77],[65, 75],[66, 75],[67, 83],[68, 70],[69, 72],[70, 76],[71, 77],[72, 78],[73, 77],[74, 73],[75, 74],[76, 81],[77, 79],[78, 80],[79, 82],[80, 81],[81, 81],[82, 76],[83, 78],[84, 80],[85, 66],[86, 81],[87, 76],[88, 75],[89, 78],[90, 83],[91, 82],[92, 77],[93, 79],[94, 76],[95, 72],[96, 79],[97, 73],[98, 86],[99, 77],[100, 79],];
    var new_win = [[1, 48],[2, 41],[3, 36],[4, 45],[5, 33],[6, 29],[7, 28],[8, 27],[9, 31],[10, 21],[11, 28],[12, 26],[13, 24],[14, 25],[15, 14],[16, 21],[17, 10],[18, 21],[19, 17],[20, 22],[21, 16],[22, 12],[23, 13],[24, 17],[25, 17],[26, 16],[27, 17],[28, 10],[29, 19],[30, 18],[31, 20],[32, 18],[33, 12],[34, 15],[35, 10],[36, 9],[37, 9],[38, 18],[39, 10],[40, 14],[41, 19],[42, 20],[43, 16],[44, 11],[45, 9],[46, 7],[47, 14],[48, 16],[49, 16],[50, 13],[51, 12],[52, 14],[53, 17],[54, 14],[55, 10],[56, 10],[57, 13],[58, 10],[59, 9],[60, 20],[61, 9],[62, 18],[63, 10],[64, 8],[65, 14],[66, 11],[67, 7],[68, 15],[69, 17],[70, 12],[71, 12],[72, 6],[73, 11],[74, 14],[75, 15],[76, 5],[77, 14],[78, 11],[79, 10],[80, 10],[81, 6],[82, 13],[83, 8],[84, 4],[85, 17],[86, 9],[87, 11],[88, 12],[89, 10],[90, 7],[91, 11],[92, 9],[93, 12],[94, 16],[95, 12],[96, 12],[97, 15],[98, 7],[99, 7],[100, 9],];
    var new_draw = [[1 ,16],[2 ,16],[3 ,15],[4 ,16],[5 ,16],[6 ,16],[7 ,10],[8 ,22],[9 ,18],[10 ,13],[11 ,16],[12 ,13],[13 ,16],[14 ,15],[15 ,17],[16 ,17],[17 ,12],[18 ,21],[19 ,16],[20 ,11],[21 ,12],[22 ,22],[23 ,16],[24 ,18],[25 ,21],[26 ,15],[27 ,9],[28 ,21],[29 ,9],[30 ,15],[31 ,16],[32 ,17],[33 ,9],[34 ,17],[35 ,17],[36 ,15],[37 ,10],[38 ,10],[39 ,10],[40 ,10],[41 ,16],[42 ,13],[43 ,14],[44 ,20],[45 ,17],[46 ,18],[47 ,18],[48 ,6],[49 ,11],[50 ,11],[51 ,14],[52 ,12],[53 ,17],[54 ,16],[55 ,11],[56 ,10],[57 ,8],[58 ,16],[59 ,18],[60 ,18],[61 ,10],[62 ,13],[63 ,9],[64 ,15],[65 ,11],[66 ,14],[67 ,10],[68 ,15],[69 ,11],[70 ,12],[71 ,11],[72 ,16],[73 ,12],[74 ,13],[75 ,11],[76 ,14],[77 ,7],[78 ,9],[79 ,8],[80 ,9],[81 ,13],[82 ,11],[83 ,14],[84 ,16],[85 ,17],[86 ,10],[87 ,13],[88 ,13],[89 ,12],[90 ,10],[91 ,7],[92 ,14],[93 ,9],[94 ,8],[95 ,16],[96 ,9],[97 ,12],[98 ,7],[99 ,16],[100 ,12]];

    Flotr.draw(
        document.getElementById("new_random"),
        [
            {data: new_lose, label: "勝ち"},
            {data: new_win, label: "負け"},
            {data: new_draw, label: "引分"}
        ],
        {
            title: "従来の方法、重みを加減算",
            subtitle: "対乱数プログラム",
            HtmlText: false,
            bars:{show: true, stacked: true, horizontal:false},
            xaxis:{
                title: "対戦回数（×１００）",
                max: 110,
                noTicks: 10
            },
            yaxis:{
                title: "対戦結果（勝ち／負け／引き分け）",
                titleAngle: 90,
                max: 100,
                noTicks: 10
            },
            grid: {
                verticalLines: true,
                horizontalLines: true,
                outline: "ws"
            },
            mouse: {
                track:true,
                trackDecimals: 0
            }
        }
    );
}
    
function show_neural_random(){
    var old_lose = [[1, 45],[2, 47],[3, 57],[4, 45],[5, 53],[6, 58],[7, 56],[8, 51],[9, 60],[10, 64],[11, 59],[12, 62],[13, 54],[14, 58],[15, 64],[16, 69],[17, 62],[18, 60],[19, 66],[20, 66],[21, 70],[22, 70],[23, 74],[24, 75],[25, 70],[26, 78],[27, 71],[28, 78],[29, 73],[30, 73],[31, 70],[32, 73],[33, 79],[34, 83],[35, 83],[36, 74],[37, 71],[38, 77],[39, 82],[40, 77],[41, 79],[42, 87],[43, 75],[44, 79],[45, 77],[46, 84],[47, 83],[48, 84],[49, 81],[50, 76],[51, 81],[52, 85],[53, 80],[54, 89],[55, 80],[56, 86],[57, 85],[58, 86],[59, 84],[60, 87],[61, 85],[62, 89],[63, 82],[64, 86],[65, 75],[66, 74],[67, 83],[68, 78],[69, 84],[70, 78],[71, 89],[72, 85],[73, 88],[74, 85],[75, 77],[76, 88],[77, 85],[78, 87],[79, 77],[80, 86],[81, 81],[82, 86],[83, 79],[84, 79],[85, 78],[86, 85],[87, 87],[88, 85],[89, 86],[90, 72],[91, 82],[92, 85],[93, 84],[94, 86],[95, 83],[96, 90],[97, 87],[98, 86],[99, 82],[100, 84]];
    var old_win = [[1, 46],[2, 38],[3, 35],[4, 39],[5, 38],[6, 29],[7, 30],[8, 40],[9, 27],[10, 23],[11, 32],[12, 25],[13, 30],[14, 19],[15, 26],[16, 19],[17, 26],[18, 26],[19, 23],[20, 18],[21, 20],[22, 19],[23, 19],[24, 15],[25, 20],[26, 13],[27, 18],[28, 15],[29, 16],[30, 18],[31, 20],[32, 17],[33, 10],[34, 6],[35, 12],[36, 15],[37, 17],[38, 15],[39, 10],[40, 11],[41, 13],[42, 6],[43, 13],[44, 11],[45, 15],[46, 4],[47, 9],[48, 13],[49, 10],[50, 9],[51, 7],[52, 9],[53, 12],[54, 7],[55, 8],[56, 9],[57, 7],[58, 9],[59, 8],[60, 9],[61, 4],[62, 4],[63, 12],[64, 7],[65, 14],[66, 16],[67, 8],[68, 7],[69, 10],[70, 10],[71, 7],[72, 8],[73, 3],[74, 9],[75, 13],[76, 6],[77, 7],[78, 9],[79, 11],[80, 5],[81, 5],[82, 8],[83, 5],[84, 12],[85, 11],[86, 4],[87, 8],[88, 9],[89, 9],[90, 11],[91, 11],[92, 8],[93, 7],[94, 7],[95, 13],[96, 4],[97, 8],[98, 8],[99, 6],[100, 9]];
    var old_draw = [[1 ,9],[2 ,15],[3 ,8],[4 ,16],[5 ,9],[6 ,13],[7 ,14],[8 ,9],[9 ,13],[10 ,13],[11 ,9],[12 ,13],[13 ,16],[14 ,23],[15 ,10],[16 ,12],[17 ,12],[18 ,14],[19 ,11],[20 ,16],[21 ,10],[22 ,11],[23 ,7],[24 ,10],[25 ,10],[26 ,9],[27 ,11],[28 ,7],[29 ,11],[30 ,9],[31 ,10],[32 ,10],[33 ,11],[34 ,11],[35 ,5],[36 ,11],[37 ,12],[38 ,8],[39 ,8],[40 ,12],[41 ,8],[42 ,7],[43 ,12],[44 ,10],[45 ,8],[46 ,12],[47 ,8],[48 ,3],[49 ,9],[50 ,15],[51 ,12],[52 ,6],[53 ,8],[54 ,4],[55 ,12],[56 ,5],[57 ,8],[58 ,5],[59 ,8],[60 ,4],[61 ,11],[62 ,7],[63 ,6],[64 ,7],[65 ,11],[66 ,10],[67 ,9],[68 ,15],[69 ,6],[70 ,12],[71 ,4],[72 ,7],[73 ,9],[74 ,6],[75 ,10],[76 ,6],[77 ,8],[78 ,4],[79 ,12],[80 ,9],[81 ,14],[82 ,6],[83 ,16],[84 ,9],[85 ,11],[86 ,11],[87 ,5],[88 ,6],[89 ,5],[90 ,17],[91 ,7],[92 ,7],[93 ,9],[94 ,7],[95 ,4],[96 ,6],[97 ,5],[98 ,6],[99 ,12],[100 ,7]];

    Flotr.draw(
        document.getElementById("neural_random"),
        [
            {data: old_lose, label: "勝ち"},
            {data: old_win, label: "負け"},
            {data: old_draw, label: "引分"}
        ],
        {
            title: "ニューラルネットワーク、勾配法（修正後）",
            subtitle: "対乱数プログラム",
            HtmlText: false,
            bars:{show: true, stacked: true, horizontal:false},
            xaxis:{
                title: "対戦回数（×１００）",
                max: 110,
                noTicks: 10
            },
            yaxis:{
                title: "対戦結果（勝ち／負け／引き分け）",
                titleAngle: 90,
                max: 100,
                noTicks: 10
            },
            grid: {
                verticalLines: true,
                horizontalLines: true,
                outline: "ws"
            },
            mouse: {
                track:true,
                trackDecimals: 0
            }
        }
    );
}

window.onload = function() {
    show_new_saikyo();
    show_neural_saikyo();
    show_new_random();
    show_neural_random();
};
</script>

<hr>


    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#project-ref">
    		project <span>23</span>
    	</a></li>
    
  


    </ul>
    

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#software-ref">software <span>15</span></a></li>
     
    	<li><a href="/tags.html#ruby-ref">ruby <span>32</span></a></li>
     
    	<li><a href="/tags.html#tictactoe-ref">tictactoe <span>30</span></a></li>
     
    	<li><a href="/tags.html#android-ref">android <span>38</span></a></li>
     
    	<li><a href="/tags.html#javascript-ref">javascript <span>38</span></a></li>
    
  



    </ul>
    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/project/2017-07-01/neuralnw" title="三目並べでニューラルネットワーク（誤）">← Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/project/2017-07-11/tictactoe-van" title="「消える三目並べ」リリースしました">Next →</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'hello-my-world'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';        
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
</div>

<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://hello-my-world.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>

      </div>
      <hr>
      <footer>
        <p>© 2019 happyclam
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

